<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>RunNow</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            --bs-bg-opacity: 1;
            background-color: rgba(var(--bs-tertiary-bg-rgb), var(--bs-bg-opacity)) !important;
            margin:20px;
        }
    </style>


</head>
<body>
    <div class="container">
        <h3 class="mb-4">2025 마라톤 일정 🏃‍♂️</h3>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>


<script type="text/javascript">
const csvUrl = 'https://docs.google.com/spreadsheets/d/1z67BXtYTMB0PySBjvTMz_IOiOy3JCKCx/export?format=csv';

Papa.parse(csvUrl, {
  download: true,
  header: true,
  complete: function(results) {
    const data = results.data;
    data.forEach(row => {
        $('.container').append(`

            <div class="card mb-3 shadow-sm rounded-4 bg-white">
            <div class="card-body p-3 d-flex flex-row align-items-center">
                <!-- 날짜 박스 -->
                <div class="bg-light rounded-3 d-flex flex-column justify-content-center align-items-center me-3" style="width: 80px; height: 80px;">
                <div class="fw-light fs-4">${row.Date1}</div>
                <div class="text-muted small">${row.Date2}</div>
                </div>

                <!-- 마라톤 정보 -->
                <div class="flex-grow-1">
                <div class="d-flex justify-content-between align-items-start mb-1">
                    <div>
                    <h5 class="mb-1 fw-bold">${row.Name}</h5>
                    <div class="text-muted small">${row.Location}</div>
                    </div>
                    <div class="status">
                    <span class="badge text-bg-dark">${row.Status}</span>
                    </div>
                </div>

                <!-- 태그들 -->
                <div class="course-tags" data-course="${row.Course}"></div>
                </div>
            </div>
            </div>
        `);
          
        $('.course-tags').each(function () {
            const courseStr = $(this).data('course'); // 예: "Half,10K,5K"
            if (!courseStr) return;

            const courses = courseStr.split(',').map(c => c.trim());

            const tags = courses.map(course => {
              let tagClass = 'text-bg-light';
              if (/half/i.test(course)) tagClass = 'text-bg-dark';
              else if (/full/i.test(course)) tagClass = 'text-bg-info';
              return `<span class="badge rounded-pill ${tagClass}">${course}</span>`;
              
            });

            $(this).html(tags.join(' '));
          });
          
          $('.status').each(function () {
            const statusText = $(this).text().trim(); // 예: '마감', '접수중', '예정'

            // 상태에 따라 클래스 매핑
            const statusClassMap = {
              '마감': 'text-bg-light',
              '접수중': 'text-bg-warning',
              '예정': 'text-bg-dark'
            };

            const badgeClass = statusClassMap[statusText] || 'text-bg-secondary';

            // 기존 텍스트 지우고 span 삽입
            $(this).html(`<span class="badge ${badgeClass}">${statusText}</span>`);
          });
          

    });
  }
});
</script>

</body>
</html>